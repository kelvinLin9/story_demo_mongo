<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>聊天室測試</title>
    <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
    <style>
        /* CSS 省略，保持不變 */
    </style>
</head>
<body>
    <ul id="messages"></ul>
    <form id="message-form">
        <input id="m" autocomplete="off" /><button>發送</button>
    </form>

    <script>
        var socket = io('https://story-demo-mongo.onrender.com/');

        socket.emit('joinRoom', { username: 'TestUser', room: 'TestRoom' });

        socket.on('message', function(data) {
            const { message, username, time } = data;
            const formattedTime = new Date(time).toLocaleTimeString();
            var item = document.createElement('li');
            item.textContent = `${username} @ ${formattedTime}: ${message}`;
            document.getElementById('messages').appendChild(item);
            window.scrollTo(0, document.body.scrollHeight);
        });

        document.getElementById('message-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const message = document.getElementById('m').value;
            if (message) {
                socket.emit('chatMessage', {
                    message: message,
                    username: 'TestUser', // 這裡應該替換為從某處獲取的實際用戶名
                    time: new Date() // 發送當前時間
                });
                document.getElementById('m').value = '';
            }
        });
    </script>
</body>
</html>
